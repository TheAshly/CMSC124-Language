//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣛⣿⣝⣻⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢯⣿⣿⣿⣿⣿⣿⣷⢽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣟⣛⠿⣿⣿⢎⡟⣫⣶⣷⣿⣷⣾⣵⣝⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣟⣭⣷⣿⠟⠻⠿⣷⣎⠊⣴⠿⣹⡶⣿⣽⣝⡿⢿⣿⣮⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⣯⣵⣿⣿⡿⠟⣁⣐⣦⣥⡘⣿⣿⡷⢟⡛⠻⣯⣿⣿⣿⢷⣝⣻⣳⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣝⣻⣟⡛⢯⢿⣞⡿⣽⣿⣿⢟⣡⣾⡿⢩⣐⢦⣿⣿⣿⣿⣿⣷⣦⡈⠹⣿⣿⣷⣟⣷⢷⣮⡽⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣻⣽⡾⣿⣿⣿⡟⣷⣾⣿⢣⣶⣿⢟⣿⣿⣿⢿⣿⣿⣝⣿⣿⣧⡌⣿⣿⡿⣯⣿⡹⢭⡓⢾⣹⣻⣟⣻⣻⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣭⡿⣳⣯⡿⣿⣿⣟⣾⢯⣿⣣⣿⣿⡹⣟⣯⣿⣿⢺⣿⣷⢿⣞⢿⣿⣳⣌⢿⣿⡽⣷⣙⢦⡙⢣⣍⡻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣻⣾⡷⣽⣿⣟⣿⣿⣯⡾⣵⣟⣾⡿⣽⢷⢿⣿⣼⣿⣿⢼⡇⣿⣻⣹⣿⢯⣳⡝⣮⣷⢻⡌⢷⡊⢶⠁⢆⡙⠾⣽⡻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢟⣵⡿⣿⣾⠿⣗⣿⣿⢿⣿⢱⣿⣾⣟⣾⠟⣾⣻⢾⣿⣻⡿⣿⣇⡷⣇⢧⡹⣷⢣⠹⡌⢯⣗⢫⢒⡝⢦⣉⠢⢄⢣⠨⡙⢯⣝⣟⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠣⣿⣽⡾⣿⣽⢾⣿⣿⣟⣿⢇⣯⣿⡟⣾⠟⢸⡇⣿⡯⣿⣼⣿⢿⠇⡧⣿⢨⡒⠽⣏⠮⣙⢢⠹⡎⡜⣌⢣⠰⡁⢎⡄⢣⢧⣦⡙⠾⡽⣯⣷⣶⣶⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⣽⣯⢷⣷⣼⣯⢿⣿⣿⣿⣾⡟⡜⣾⡟⣼⢏⢪⢹⣐⢻⣿⢽⡆⣿⡿⡸⠔⢻⢠⡙⡔⡹⣆⠣⢎⠥⣛⠴⣈⢇⡒⢍⢢⡘⢆⢚⣿⣿⣷⣜⠽⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⡿⣳⣿⣟⣾⣻⣾⢾⣯⣿⢯⡿⣦⣿⡇⢹⡿⣸⢃⣢⣿⣞⡸⣾⢿⣯⣷⢸⡹⢡⢣⣽⢲⣥⢊⡱⢌⠳⣈⠖⡬⠰⣍⠲⣠⢋⠴⡈⢎⡌⣻⣿⣿⣿⣷⡹⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⢻⣿⣟⡾⣧⠟⡽⢋⣾⠟⣾⣿⢻⣿⢈⡻⢡⠓⣼⣾⣿⢲⣽⣇⠞⣿⣎⡗⣸⠡⢾⣯⢻⣧⣗⡰⢉⠖⡌⠜⡄⠳⣸⠱⠤⢌⢂⠓⠄⡚⣤⣻⣿⣿⣿⣷⣹⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⡾⣗⠞⢌⢹⡏⣾⣿⡟⣿⡟⢠⢋⡔⣚⣽⣯⢭⠮⣭⣭⢧⣹⢻⣜⠤⣋⡿⠣⣝⣿⣹⣚⡡⡜⢌⠣⢜⡰⢹⣇⢋⡰⢃⠎⡄⡱⢂⣳⡽⣿⣿⡿⣽⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⢳⣟⡾⡭⣸⡞⡟⣌⣿⢿⣁⣿⡝⡔⢊⠼⠍⠓⠋⠙⠓⢰⣜⣧⢳⡍⢿⣢⠱⣯⠱⠞⠐⠚⠛⠑⢎⢆⢓⡀⢳⣹⡇⢎⠄⣣⢃⠲⣽⡌⢼⣷⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⡟⣿⡷⣿⣿⢟⡗⡼⣟⣿⡄⣿⢹⠀⡍⠀⡔⢒⡀⠀⠄⣤⣟⣿⣞⣿⣤⡳⣒⣝⣿⣥⠒⠂⠀⣀⢠⠀⠢⣌⠓⣾⢡⡋⠴⠠⣃⠂⣿⣿⢸⣿⡏⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣷⡽⣿⣾⢶⢧⣿⣟⡇⢿⡘⣦⢽⣷⡻⣄⠽⣚⢣⣿⣿⣿⣿⣿⣷⣷⣧⣽⣿⣿⣌⠳⣖⢰⣾⣔⡳⢈⣳⡟⢢⡙⠂⢥⡂⠵⣌⢿⣻⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⢎⡟⡰⢏⢿⡹⡕⣒⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣿⣿⣿⢸⢣⡿⢌⠣⡜⠀⢒⢸⡆⣽⣾⡽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣳⢏⡴⡻⣞⠌⠻⣵⠊⣭⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⣓⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣏⡊⡾⢁⢎⡱⠠⡁⢎⡜⣷⢸⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣷⣵⣿⢧⣿⣿⢈⠳⡈⣓⢸⡽⣿⣿⣿⣿⣿⣿⣿⣿⣿⣜⣻⢿⣿⣿⣿⣿⣿⣿⣿⣟⣧⢚⡞⡁⠇⢊⠄⠀⡥⠒⣌⠫⡟⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⢿⣻⣵⣿⣿⣿⣿⣫⡿⣟⢬⢇⡑⠆⡁⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢇⡳⠈⠄⠌⡰⠀⢁⠐⢣⠜⣰⠩⠷⣽⣻⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⡿⣥⢯⣿⣿⣿⣿⡟⣷⡟⣼⢣⡾⠤⢩⠐⠠⠌⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢏⠮⠁⢀⠰⣈⠴⠀⠄⣌⠠⠙⣄⠙⣆⠳⢯⣟⣯⢿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⡓⢮⣿⣿⣿⣟⣯⡾⢋⢼⣟⣾⢃⠧⢁⠌⡐⠠⢈⠻⣿⣿⣿⣿⣿⣿⣷⣶⠷⣶⣾⣿⣿⣿⣿⢿⡱⠊⠀⠌⢀⠰⢂⠳⢬⡐⠘⣷⣦⡈⠖⢦⡝⢌⢻⣿⣧⢹⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⡌⣿⣽⣳⠟⣜⣾⢯⢯⣿⢃⠣⠀⡆⠰⢀⠃⣴⣇⠈⠻⢿⣿⣿⣿⣿⣷⣿⣿⣿⣿⣿⠿⡋⠆⠁⠐⠈⡀⠢⣉⢎⡱⢚⣿⣤⡉⠿⣿⡆⡙⣿⣿⣐⢻⡿⢠⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⡟⣿⡿⣾⢯⣿⣿⣟⣾⢳⠓⡂⣬⠓⣤⣿⠀⢺⣿⠇⡀⢂⡷⣩⠻⢿⣿⣿⣿⣿⣿⠻⢁⢣⡙⡀⠂⠌⠸⡄⢠⠃⣷⣈⢇⠺⣿⣿⣷⣦⡝⣸⢿⣿⣿⣎⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⡟⣿⣷⡿⣿⣿⣽⣿⡏⢆⡡⢟⣣⣶⣿⣿⣴⠸⡏⡀⢤⠂⣿⣧⣏⠧⣍⡛⠟⠉⢠⡰⣉⠶⣩⠐⡄⠘⢆⡹⢦⡘⢹⣯⢮⢡⠛⣿⣿⣯⣵⣿⣯⢿⣿⣧⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣟⣿⣳⢳⣿⡇⢦⣾⣿⣿⣿⣿⣿⣿⠓⡰⠀⠸⣿⣯⡿⣿⣯⡲⣝⡲⣍⢦⡱⢭⢚⡥⡚⠅⠀⠘⢿⢢⣧⡋⣽⣿⣧⡩⠘⡝⢿⣿⣿⣟⣿⣿⣷⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣻⢿⣿⡇⣿⣿⣿⣿⣿⣿⡿⢉⠖⡡⠀⣹⣻⡟⢿⣶⣍⡻⢦⣛⢬⣣⠝⡮⢜⡲⣙⠆⠀⢀⠈⠧⣿⣷⣌⡻⣥⣗⠩⣮⡒⡻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣿⣞⣬⠻⣞⠿⡿⣫⣿⠟⡁⢎⡜⠡⠐⠦⣍⢻⣦⡙⢿⠳⣣⢾⡿⣱⢋⡔⣫⠴⢁⠎⠀⠀⠀⠀⠌⠻⣿⣿⣷⡾⢡⣿⣷⢡⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣶⣿⢮⣭⡷⠟⢡⠒⢈⡒⠬⡑⠀⢩⢿⣦⢭⡛⠬⢓⣎⠊⡤⢡⠳⠌⣡⠒⡭⠂⠀⠀⠀⠀⠀⠀⠹⢿⣿⡇⣽⣿⣿⣇⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⢛⠩⢅⠎⣅⠋⢦⢉⡒⣉⠆⠸⣬⡙⠿⣗⢸⠙⠃⠀⠡⢰⣁⠮⡱⣉⠄⣀⠒⠀⠀⠁⠀⠈⠀⠀⠉⠚⠻⣿⣿⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⣿⣿⣿⣿⡿⠿⣛⢩⢡⠒⡌⠃⣨⠊⡜⡄⣋⢆⠣⢜⡠⢃⠄⢳⣻⣧⣾⡌⠅⠐⣄⠃⢀⠭⣶⣑⠌⣐⠢⠁⠀⠀⠀⠀⠠⠀⠀⠀⠀⠀⠀⠈⠙⠛⠿⠿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⣿⠟⡩⢄⠰⣐⠣⢌⡂⢣⠍⠤⡙⢠⠓⡬⡐⢆⡊⡱⢊⠴⡉⢆⣠⣿⡟⣱⢸⠜⠑⠀⡀⣎⠖⡭⣿⣦⣡⠁⠈⡜⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⣿⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⣿⠏⡬⡑⢆⠓⡌⢓⠬⡘⠥⢊⠕⡨⠃⡚⢤⠙⡢⢑⠅⠈⢦⢙⣶⣿⡟⡼⢡⣟⠢⣯⡌⢇⢺⣯⡔⡻⣿⣷⣍⢦⡀⠀⠁⠐⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿
//⣿⣿⡯⡘⡔⡩⢜⡀⢎⡱⠈⡕⣊⠡⢎⡱⠤⣉⢆⠣⢅⠋⠀⠈⣲⣾⣿⣿⣼⡯⣹⣟⣸⣿⣷⢭⢸⣿⣿⡴⡁⠉⢿⣄⠙⢦⡀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠀⠸⣿⣿⣿⣿⣿⣿
//⣿⣿⢡⠱⣌⠑⡆⢦⠐⠥⢘⡰⣁⠖⡀⠢⠱⡌⢢⠉⠆⠀⠁⣼⣿⡿⢋⠹⣿⡇⣿⣏⡿⠛⣿⣮⢹⣿⣿⣷⡱⣈⣼⣿⣿⣷⣿⣶⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢻⣿⣿⣿⣿⣿
//⣿⡏⢢⠱⡌⢣⠘⢢⠜⡱⠀⡖⢠⠚⡌⡱⢀⠈⠐⢃⢆⣀⣿⣿⣿⠁⠆⣞⣿⢿⣿⣽⣧⠱⣘⣿⡼⣿⣿⣿⣕⢣⠞⣿⣿⣿⡛⣿⠿⢦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿
//⣿⠸⣠⠓⡌⢣⡀⠃⡎⠴⣀⠃⢢⡙⠴⡁⢇⠚⠤⣀⢠⣾⣿⣿⣿⣷⣬⢾⡿⣌⡟⣾⢻⣷⣿⣿⣧⢻⡹⣿⣿⣧⢛⡜⣿⣿⡽⠀⡏⠆⠀⠀⠀⠀⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠰⠀⣿⣿⣿⣿⣿
//⡏⡶⡇⠭⣘⠠⢆⠀⠘⠰⠤⡁⠆⣍⢒⡑⡊⡍⢒⠤⢋⠲⣩⢻⣿⣿⢏⠞⡷⣘⢦⣿⢣⣿⣿⡿⢿⣇⠳⣍⢿⡏⠡⢞⡹⡈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⡄⢻⣿⣿⣿⣿⣿
//⢸⡷⣇⠓⡌⠆⢑⡊⠀⠄⡓⠀⡣⢒⠌⡔⠱⡈⠥⡊⡜⢠⠑⠂⠀⠈⢎⡹⣱⢃⢸⣿⣷⣿⣿⠀⢆⠹⣎⠵⠊⢷⣽⡆⠱⠁⠀⠀⠀⠀⠀⠁⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠳⡘⡨⣿⣿⣿⣿⣿
//⣟⣿⢯⡘⠴⣉⢂⠨⡑⡀⠘⢠⡑⣊⠜⣨⠑⡌⡅⠱⢌⠣⠜⡰⣀⡀⢎⡱⢎⠞⣸⣿⣿⡿⢟⠊⢆⢖⡉⢦⣀⢎⡻⠟⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⢠⠣⣍⠔⢿⣿⣿⣿⣿
//⢿⣽⡾⣆⠱⠠⢃⢆⠀⠡⠀⢠⠓⣄⢋⡔⢡⢂⠘⢡⠎⣑⢊⡱⠰⣐⠢⣀⠉⠈⠸⣐⠶⡸⢥⡂⠈⠢⠙⠦⠉⠊⠀⠀⠀⠀⠀⡀⠄⠀⠀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⢇⡚⢤⡋⡼⣿⣿⣿⣿
//-----------------------------WATCH VIOLET EVERGARDEN-----------------------------------

fun main(){
    // Calls Scanner
    val scanner = Scanner()
    val parser = Parser()
//    val printer = Printer()
    val evaluator = Evaluator()
    while(true) {
        print(">")
        val input = readln()
        val tokens = scanner.scanLine(input)
        val tree = parser.parseTokens(tokens)
//        printer.scannerPrinter(tokens)
//        printer.parserPrinter(tree)
        if(tree != null){
            println(evaluator.evaluateTree(tree))
        }
        System.gc()
    }
}